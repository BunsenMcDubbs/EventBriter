<template name="view_event">
  <small class="text-muted">Event id: {{_id}}</small>
  <div class="event-details jumbotron">
    <div class="row">
      <div class="col-xs-12 col-sm-6 text-sm-right">
        <h1>{{name}}</h1>
        <div>By {{owner.name}}</div>
      </div>
      <div class="col-xs-12 col-sm-6">
        <div>at {{location}}</div>
        <div>from {{ display_date start }} to {{ display_date end }}</div>
      </div>
    </div>
  </div>
  <div class="event-description card card-block">
    {{#if description}}
      {{#markdown}}{{description}}{{/markdown}}
    {{else}}
      No description available
    {{/if}}
  </div>
  <form class="js-claim-tickets">
    <div class="list-group">
      {{ #each ticket in (get_val tickets) }}
      <div class="form-group list-group-item">
        {{> view_ticket_choice ticket=ticket }}
      </div>
      {{ /each }}
    </div>
    <div class="form-group">
      <button type="submit" class="btn btn-primary js-claim-tickets-btn">
        Register
      </button>
    </div>
  </form>

  {{#if isOwner}}
  <a href="/events/{{_id}}/edit" class="btn btn-secondary">Edit</a>
  <a href="/events/{{_id}}/manage" class="btn btn-secondary">Manage</a>
  {{/if}}
</template>

<template name="edit_event">
  <div class="card card-block">
    <h2 class="card-title">
    {{#if new_event}}
    New Event!
    {{else}}
    Edit event #{{_id}}!
    {{/if}}
    </h2>
    <form class="row edit_event">
      <fieldset class="form-group col-xs-12">
        <input type="text" class="form-control" name="name"
          placeholder="Event Name" value="{{name}}">
      </fieldset>
      <fieldset class="form-group col-xs-12">
        <input type="text" class="form-control" name="location"
          placeholder="Event Location" value="{{location}}">
      </fieldset>
      <fieldset class="form-group col-xs-6">
        <input type="date" class="form-control" name="start"
          placeholder="Start Date" value="{{ display_date start }}">
      </fieldset>
      <fieldset class="form-group col-xs-6">
        <input type="date" class="form-control" name="end"
          placeholder="End Date" value="{{ display_date end }}">
      </fieldset>
      <fieldset class="form-group col-xs-12">
        <textarea name="description" rows="4" class="form-control">{{description}}</textarea>
      </fieldset>
      <div class="form-group col-xs-12">
        <div class="list-group">
          {{ #each ticket in (get_val tickets) }}
          <div class="list-group-item">
            {{> edit_ticket_choice ticket=ticket }}
          </div>
          {{ /each }}
          <div class="list-group-item list-group-item-danger new-ticket">
            {{> edit_ticket_choice ""}}
          </div>
        </div>
        <button class="btn btn-primary add-new-ticket">+</button>
      </div>
      <fieldset class="form-group col-xs-12">
        <button type="submit" class="btn btn-success-outline">Save</button>
      </fieldset>
    </form>
    {{#unless new_event}}
    <a href="/events/{{_id}}" class="btn btn-secondary">View</a>
    <a href="/events/{{_id}}/manage" class="btn btn-secondary">Manage</a>
    {{/unless}}
  </div>
</template>

<template name="manage_event">
  <h1>Manage event #{{_id}}</h1>
  {{ #each ticket_type in (get_val tickets) }}
    {{> ticket_table tickets=(object_values ticket_type.sold) }}
  {{/each}}
  <a href="/events/{{_id}}" class="btn btn-secondary">View</a>
  <a href="/events/{{_id}}/edit" class="btn btn-secondary">Edit</a>
</template>
